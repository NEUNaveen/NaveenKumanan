<!DOCTYPE html>
<html lang="en">
<head>
    <title>coffee logging</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <!-- bootstrap icons CDN(used to include bootstrap icons essentially) below -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" integrity="sha384-tViUnnbYAV00FLIhhi3v/dWt3Jxw4gZQcNoSCxCIFNJVCx7/D55/wXsrNIRANwdD" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <script>
        $(document).ready(function(){
            $("#GCButton").on("click", function(event){
                event.preventDefault();
                
                var cnameField = $('#cname');
                var cname = cnameField.val();
                
                var url = "http://localhost:5500/findGrowersCountry";

                var params = {};
                if (cname) {
                    params["cname"] = cname;
                }
                
                $.get(url, params, function(data, status) {
                    if (status == "success") { 
                        $('#resultsGC tr').remove();
                        
                        $.each(data, function(i, e) {
                            $('#resultsGC').append(
                                $('<tr>').append(
                                    $('<td>').text(e['gid']),
                                    $('<td>').text(e['gname']),
                                    $('<td>').text(e['greg']),
                                    $('<td>').text(e['gfe']),
                                    $('<td>').text(e['cname']),
                                )
                            );
                        });                  
                    }
                });
            });

            $("#TRPButton").on("click", function(event){
                event.preventDefault();

                var url = "http://localhost:5500/findTopProducts";

                params = {};
                $.get(url, params, function(data, status) {
                    if (status == "success") {   
                        $('#TRPresults tr').remove();
                        
                        $.each(data, function(i, e) {
                            $('#TRPresults').append(
                                $('<tr>').append(
                                    $('<td>').text(e['pname']),
                                    $('<td>').text(e['pprice']),
                                    $('<td>').text(e['rnumber']),
                                    $('<td>').text(e['rdesc']),
                                )
                            );
                        });                 
                    }
                });
            });

            $("#TVButton").on("click", function(event){
                event.preventDefault();

                var url = "http://localhost:5500/findTopVarietals";

                params = {};
                $.get(url, params, function(data, status) {
                    if (status == "success") {   
                        $('#TVresults tr').remove();
                        
                        $.each(data, function(i, e) {
                            $('#TVresults').append(
                                $('<tr>').append(
                                    $('<td>').text(e['vname']),
                                    $('<td>').text(e['count']),
                                )
                            );
                        });                 
                    }
                });
            });

            $("#TButton").on("click", function(event){
                event.preventDefault();

                var rnamefield = $('#rname');
                var rname = rnamefield.val();

                var fdatefield = $('#fdate');
                var fdate = fdatefield.val();

                var tdatefield = $('#tdate');
                var tdate = tdatefield.val();
            
                var params = {};
                if (rname && fdate && tdate) {
                    params["rname"] = rname;
                    params["fdate"] = fdate;
                    params["tdate"] = tdate;
                }

                var url = "http://localhost:5500/findTastings";

                $.get(url, params, function(data, status) {
                    if (status == "success") {   
                        $('#Tresults tr').remove();
                        
                        $.each(data, function(i, e) {
                            $('#Tresults').append(
                                $('<tr>').append(
                                    $('<td>').text(e['rname']),
                                    $('<td>').text(e['pname']),
                                    $('<td>').text(e['pprice']),
                                    $('<td>').text(e['tdate']),
                                    $('<td>').text(e['tdesc']),
                                )
                            );
                        });                 
                    }
                });
            });

            $("#PNButton").on("click", function(event){
                event.preventDefault();

                var notefield = $('#note');
                var note = notefield.val();
            
                var params = {};
                if (note) {
                    params["note"] = note;
                }

                var url = "http://localhost:5500/findProductsNotes";

                $.get(url, params, function(data, status) {
                    if (status == "success") {   
                        $('#PNresults tr').remove();
                        
                        $.each(data, function(i, e) {
                            $('#PNresults').append(
                                $('<tr>').append(
                                    $('<td>').text(e['note']),
                                    $('<td>').text(e['pname']),
                                    $('<td>').text(e['prank']),
                                )
                            );
                        });                 
                    }
                });
            });



        });
    </script>
</head>
    <body>

        <div class="container">
            <h1>Coffee Logging</h1>
            <nav>
                <a href="http://localhost:8000/RequiredTasks/page1.html">Create and View Roasters</a> |
                <a href="http://localhost:8000/RequiredTasks/page2.html">Create and View Products and Batches</a> |
                <a href="http://localhost:8000/RequiredTasks/page3.html">Log a Tasting</a> |
                <a href="http://localhost:8000/RequiredTasks/page4.html">Required Tasks Reports</a> |
                <a href="http://localhost:8000/Reports/page5.html">Complex Reports</a>
            </nav>
            <h2>Required Reports</h2>
          
            <h3>Find Growers</h3>
            <form id="GCform">
                <div class="form-group">
                    <label for="cname">Find growers from a country, enter the country name</label>
                    <input type="text" class="form-control" id="cname" name="cname" placeholder="" />
                </div>

                <button type="submit" class="btn btn-default" id="GCButton">Submit</button>
                <hr />

                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>id</th>
                            <th>name</th>
                            <th>regioin</th>
                            <th>farm elevation</th>
                            <th>country name</th>
                        </tr>
                    </thead>
                    <tbody id="resultsGC">
                    </tbody>
                </table>

            </form>

            <h3>Top Rated Products</h3>
            <button type="submit" class="btn btn-default" id="TRPButton">Search</button>
            <hr />

            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Product Name</th>
                        <th>Price</th>
                        <th>Rating Number</th>
                        <th>Rating Description</th>
                    </tr>
                </thead>
                <tbody id="TRPresults">
                </tbody>
            </table>

            <h3>Number of times each varietal has recieved one of the top-2 ratings</h3>
            <button type="submit" class="btn btn-default" id="TVButton">Search</button>
            <hr />

            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Varietal</th>
                        <th>Count</th>
                    </tr>
                </thead>
                <tbody id="TVresults">
                </tbody>
            </table>

            <h3>Tastings from a roaster</h3>
            <form id="Tform">
                <div class="form-group">
                    <label for="rname">Enter the roaster's name</label>
                    <input type="text" class="form-control" id="rname" name="rname" placeholder="" />
                </div>

                <div class="form-group">
                    <label for="fdate">From Date</label>
                    <input type="date" class="form-control" id="fdate" name="fdate" placeholder="" />
                </div>

                <div class="form-group">
                    <label for="tdate">To Date</label>
                    <input type="date" class="form-control" id="tdate" name="tdate" placeholder="" />
                </div>

                <button type="submit" class="btn btn-default" id="TButton">Submit</button>
                <hr />

                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Roaster Name</th>
                            <th>Product Name</th>
                            <th>Product Price</th>
                            <th>Tasting Date</th>
                            <th>Tasting Description</th>

                        </tr>
                    </thead>
                    <tbody id="Tresults">
                    </tbody>
                </table>

            </form>

            <h3>Ranked list of products given a set of notes</h3>
            <form id="PNform">
                <div class="form-group">
                    <label for="note">Enter A Note name</label>
                    <input type="text" class="form-control" id="note" name="note" placeholder="" />
                </div>

                <div class="form-group">
                    <label for="pmeth">(optional) enter a processing method (this doesn't do anything (yet))</label>
                    <input type="text" class="form-control" id="pmeth" name="pmeth" placeholder="" />
                </div>

                <button type="submit" class="btn btn-default" id="PNButton">Submit</button>
                <hr />

                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Note Name</th>
                            <th>Product Name</th>
                            <th>Rank (Sum of products ratings)</th>
                        </tr>
                    </thead>
                    <tbody id="PNresults">
                    </tbody>
                </table>

            </form>


        </div>

    </body>
</html>
