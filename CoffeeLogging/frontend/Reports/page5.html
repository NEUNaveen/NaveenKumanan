<!DOCTYPE html>
<html lang="en">
<head>
    <title>coffee logging</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <!-- bootstrap icons CDN(used to include bootstrap icons essentially) below -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" integrity="sha384-tViUnnbYAV00FLIhhi3v/dWt3Jxw4gZQcNoSCxCIFNJVCx7/D55/wXsrNIRANwdD" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <script>
        $(document).ready(function(){
            $("#TNRButton").on("click", function(event){
                event.preventDefault();
                
                var bmnameField = $('#bmname');
                var bmname = bmnameField.val();
                
                var url = "http://localhost:5500/getTastingsNotesRanked";

                var params = {};
                if (bmname) {
                    params["bmname"] = bmname;
                } else {
                    params["bmname"] = '%';
                }
                
                $.get(url, params, function(data, status) {
                    if (status == "success") { 

                        $('#TNRresults tr').remove();
                        
                        $.each(data, function(i, e) {
                            $('#TNRresults').append(
                                $('<tr>').append(
                                    $('<td>').text(e['nname']),
                                    $('<td>').text(e['bmname']),
                                    $('<td>').text(e['score']),
                                )
                            );
                        });                  
                    }
                });
            });

            $("#RLButton").on("click", function(event){
                event.preventDefault();

                var url = "http://localhost:5500/getRLCount";

                params = {};
                $.get(url, params, function(data, status) {
                    if (status == "success") {   
                        $('#RLresults tr').remove();
                        
                        $.each(data, function(i, e) {
                            $('#RLresults').append(
                                $('<tr>').append(
                                    $('<td>').text(e['rlname']),
                                    $('<td>').text(e['count']),
                                )
                            );
                        });                 
                    }
                });
            });

            $("#SRButton").on("click", function(event){
                event.preventDefault();

                var url = "http://localhost:5500/findSpendingPerRoaster";

                params = {};
                $.get(url, params, function(data, status) {
                    if (status == "success") {   
                        $('#SRresults tr').remove();
                        
                        $.each(data, function(i, e) {
                            $('#SRresults').append(
                                $('<tr>').append(
                                    $('<td>').text(e['rname']),
                                    $('<td>').text(e['spent']),
                                )
                            );
                        });                 
                    }
                });
            });

            $("#RSButton").on("click", function(event){
                event.preventDefault();

                var rnamefield = $('#rname');
                var rname = rnamefield.val();
            
                var params = {};
                if (rname) {
                    params["rname"] = rname;
                } else {
                    params["rname"] = '%';
                }

                var url = "http://localhost:5500/findRoasterScore";

                $.get(url, params, function(data, status) {
                    if (status == "success") {   
                        $('#RSresults tr').remove();
                        
                        $.each(data, function(i, e) {
                            $('#RSresults').append(
                                $('<tr>').append(
                                    $('<td>').text(e['rname']),
                                    $('<td>').text(e['score']),
                                )
                            );
                        });                 
                    }
                });
            });

            $("#ERLButton").on("click", function(event){
                event.preventDefault();

                var rlfield = $('#rl');
                var rl = rlfield.val();
            
                var params = {};
                if (rl) {
                    params["rl"] = rl;
                } else{
                    params["rl"] = "%";
                }

                var url = "http://localhost:5500/findRoastLevelExp";

                $.get(url, params, function(data, status) {
                    if (status == "success") {   
                        $('#ERLresults tr').remove();
                        
                        $.each(data, function(i, e) {
                            $('#ERLresults').append(
                                $('<tr>').append(
                                    $('<td>').text(e['rl']),
                                    $('<td>').text(e['exp']),
                                )
                            );
                        });                 
                    }
                });
            });



        });
    </script>
</head>
    <body>

        <div class="container">
            <h1>Coffee Logging</h1>
            <nav>
                <a href="http://localhost:8000/RequiredTasks/page1.html">Create and View Roasters</a> |
                <a href="http://localhost:8000/RequiredTasks/page2.html">Create and View Products and Batches</a> |
                <a href="http://localhost:8000/RequiredTasks/page3.html">Log a Tasting</a> |
                <a href="http://localhost:8000/RequiredTasks/page4.html">Required Tasks Reports</a> |
                <a href="http://localhost:8000/Reports/page5.html">Complex Reports</a>
            </nav>
            <h2>Reports</h2>
          
            <h3>Tasting Notes Ranked by sum of thier tastings ratings, optionally given a brewmethod</h3>
            <h4>motivation: find which notes you like the most, and then you  buy products with those notes. Improving your coffee tastings.</h4>

            <form id="TNRform">
                <div class="form-group">
                    <label for="bmname">(optional) Brew Method Name</label>
                    <input type="text" class="form-control" id="bmname" name="bmname" placeholder="" />
                </div>

                <button type="submit" class="btn btn-default" id="TNRButton">Search</button>
                <hr />

                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Note</th>
                            <th>Brew Method</th>
                            <th>Score (sum of all ratings from all the tastings that report this note)</th>
                        </tr>
                    </thead>
                    <tbody id="TNRresults">
                    </tbody>
                </table>

            </form>

            <h3>Number of times a roast level has recieved one of the top 3 ratings</h3>
            <h4>motivation: find which roast level you like the most!</h4>
            <button type="submit" class="btn btn-default" id="RLButton">Search</button>
            <hr />

            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Roast Level</th>
                        <th>Number of times it has recieved a top 3 vote</th>
                    </tr>
                </thead>
                <tbody id="RLresults">
                </tbody>
            </table>

            <h3>Spending per Roaster</h3>
            <h4>Know how much you have spent in each roaster based on how many batches you have and the products price</h4>
            <button type="submit" class="btn btn-default" id="SRButton">Search</button>
            <hr />

            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Roaster</th>
                        <th>Spent (USD)</th>
                    </tr>
                </thead>
                <tbody id="SRresults">
                </tbody>
            </table>

            <h3>Roaster(s) Score, optionally given a roaster's name</h3>
            <h3>See which roaster you like the most, or how much you like a roaster</h3>
            <form id="RSform">
                <div class="form-group">
                    <label for="rname">(Optional) Enter the roaster's name</label>
                    <input type="text" class="form-control" id="rname" name="rname" placeholder="" />
                </div>

                <button type="submit" class="btn btn-default" id="RSButton">Submit</button>
                <hr />

                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Roaster Name</th>
                            <th>Score (all ratings of tastings from this roaster summed)</th>
                        </tr>
                    </thead>
                    <tbody id="RSresults">
                    </tbody>
                </table>

            </form>

            <h3>Expenditure By Roast Level</h3>
            <h4>Which roast levels do you spend the most on?</h4>
            <form id="ERLform">
                <div class="form-group">
                    <label for="rl">(Optional) Enter Roast Level</label>
                    <input type="text" class="form-control" id="rl" name="rl" placeholder="" />
                </div>

                <button type="submit" class="btn btn-default" id="ERLButton">Submit</button>
                <hr />

                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Roast Level</th>
                            <th>Expenditure</th>
                        </tr>
                    </thead>
                    <tbody id="ERLresults">
                    </tbody>
                </table>

            </form>


        </div>

    </body>
</html>
